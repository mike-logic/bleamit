<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BLEAMIT Web Flasher</title>
  <script type="module" 
src="https://unpkg.com/esp-web-tools@9/dist/web/install-button.js"></script>
  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #111;
      color: #eee;
      padding: 2rem;
      max-width: 800px;
      margin: auto;
      line-height: 1.6;
    }
    h1 {
      font-size: 2rem;
    }
    .description {
      margin-bottom: 2rem;
    }
    .selector {
      display: grid;
      gap: 1rem;
      margin: 2rem 0 1rem;
    }
    .selector button {
      padding: 0.75rem;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .base     { background: #3498db; }
    .hub      { background: #2ecc71; }
    .node     { background: #f1c40f; color: #000; }
    .standalone { background: #e67e22; }
    .selected {
      box-shadow: 0 0 10px 2px #fff;
    }

    esp-web-install-button::part(button) {
      background: #4ecdc4;
      color: #000;
      padding: 0.75rem 1.5rem;
      font-size: 1.1rem;
      border-radius: 6px;
      border: none;
      cursor: pointer;
    }

    .footer {
      margin-top: 3rem;
      font-size: 0.9rem;
      opacity: 0.7;
    }
  </style>
</head>
<body>

  <h1>BLEAMIT ESP32 Web Flasher</h1>

  <div class="description">
    <p><strong>BLEAMIT</strong> is a wireless lighting sync system using 
ESP32 devices to broadcast and receive RGB color updates via ESP-NOW and 
BLE. Devices can act as a Base, Hub, Node, or Standalone depending on 
deployment needs.</p>
    <ul>
      <li><strong>ðŸŸ¦ Base</strong>: Receives Art-Net and transmits color 
via ESP-NOW</li>
      <li><strong>ðŸŸ© Hub</strong>: Relays ESP-NOW packets across large 
spaces</li>
      <li><strong>ðŸŸ¨ Node</strong>: Receives ESP-NOW color and advertises 
via BLE</li>
      <li><strong>ðŸŸ§ Standalone</strong>: Listens for Art-Net and 
advertises via BLE</li>
    </ul>
  </div>

  <h3>Select Firmware Type:</h3>
  <div class="selector">
    <button id="btn-base" class="base" onclick="setRole('base')">ðŸŸ¦ Base 
Firmware</button>
    <button id="btn-hub" class="hub" onclick="setRole('hub')">ðŸŸ© Hub 
Firmware</button>
    <button id="btn-node" class="node" onclick="setRole('node')">ðŸŸ¨ Node 
Firmware</button>
    <button id="btn-standalone" class="standalone" 
onclick="setRole('standalone')">ðŸŸ§ Standalone Firmware</button>
  </div>

  <p><strong>Selected firmware:</strong> <span 
id="current-role">Base</span></p>

  <esp-web-install-button id="flash-button" 
manifest="manifest-base.json"></esp-web-install-button>

  <p>Make sure your ESP32 is connected via USB. You may need to hold the 
BOOT button while connecting.</p>
  <p>Project repo: <a href="https://github.com/mike-logic/bleamit" 
target="_blank">github.com/mike-logic/bleamit</a></p>

  <div class="footer">
    &copy; 2025 Mike Williams â€” BLEAMIT Project
  </div>

  <script>
    const buttonMap = {
      base: 'manifest-base.json',
      hub: 'manifest-hub.json',
      node: 'manifest-node.json',
      standalone: 'manifest-standalone.json'
    };

    function setRole(role) {
      document.getElementById("flash-button").setAttribute("manifest", 
buttonMap[role]);
      document.getElementById("current-role").textContent = 
role.charAt(0).toUpperCase() + role.slice(1);
      ['base','hub','node','standalone'].forEach(r => {
        document.getElementById("btn-" + r).classList.remove('selected');
      });
      document.getElementById("btn-" + role).classList.add('selected');
    }

    setRole('base');
  </script>

</body>
</html>

